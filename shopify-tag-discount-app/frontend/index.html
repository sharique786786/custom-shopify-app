<!-- frontend/index.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>Shopify Admin UI</title>
    <script src="https://unpkg.com/@shopify/app-bridge"></script>
    <script src="https://unpkg.com/@shopify/app-bridge-utils"></script>
    <script src="https://unpkg.com/@shopify/polaris@10.0.0/build/esm/index.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/@shopify/polaris@10.0.0/build/esm/styles.css"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <div style="padding: 20px;">
      <h1>Admin Interface</h1>
      <button id="load">Load Metafields</button>
      <pre id="output" style="white-space: pre-wrap; border: 1px solid #ccc; padding: 10px;"></pre>
    </div>

    <script type="module">
      import createApp from 'https://unpkg.com/@shopify/app-bridge?module';
      import { getSessionToken } from 'https://unpkg.com/@shopify/app-bridge-utils?module';

      const app = createApp({
        apiKey: new URLSearchParams(window.location.search).get('apiKey'),
        host: new URLSearchParams(window.location.search).get('host'),
        forceRedirect: true,
      });

      document.getElementById('load').addEventListener('click', async () => {
        const token = await getSessionToken(app);

        const res = await fetch('/api/metafields', {
          headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json',
          },
        });

        const json = await res.json();
        document.getElementById('output').textContent = JSON.stringify(json, null, 2);
      });
    </script>
  </body>
</html>
